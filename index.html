<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yassine Selmi - Portfolio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <style>
        /* Styles existants */
        /* ... (garder tous les styles existants) ... */

        /* Styles pour l'assistant vocal */
        .assistant-container {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        .assistant-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s ease;
            position: relative;
            margin-bottom: 10px;
        }

        .assistant-avatar:hover {
            transform: scale(1.05);
        }

        .assistant-avatar .avatar-icon {
            font-size: 2rem;
            color: var(--light-text);
        }

        .assistant-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .assistant-container.active .assistant-controls {
            opacity: 1;
            transform: translateY(0);
            pointer-events: all;
        }

        .assistant-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
            color: var(--text-color);
        }

        .assistant-btn:hover {
            background: var(--accent-color);
            color: var(--light-text);
            transform: translateY(-3px);
        }

        .assistant-voice-indicator {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            top: 0;
            left: 0;
            opacity: 0;
            pointer-events: none;
        }

        .assistant-voice-indicator.speaking {
            animation: pulse 1.5s infinite;
        }

        .assistant-voice-indicator.listening {
            animation: listening 2s infinite;
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(56, 189, 248, 0.7);
                opacity: 1;
            }
            70% {
                box-shadow: 0 0 0 15px rgba(56, 189, 248, 0);
                opacity: 0.7;
            }
            100% {
                box-shadow: 0 0 0 0 rgba(56, 189, 248, 0);
                opacity: 0;
            }
        }

        @keyframes listening {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.7);
                opacity: 1;
            }
            50% {
                box-shadow: 0 0 0 10px rgba(37, 99, 235, 0);
                opacity: 0.7;
            }
            100% {
                box-shadow: 0 0 0 0 rgba(37, 99, 235, 0);
                opacity: 0;
            }
        }

        .assistant-bubble {
            position: absolute;
            bottom: 85px;
            left: 0;
            background: var(--card-bg);
            padding: 15px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            max-width: 300px;
            min-width: 220px;
            transform-origin: bottom left;
            transform: scale(0);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 1001;
            border: 1px solid var(--card-border);
        }

        .assistant-bubble.show {
            transform: scale(1);
            opacity: 1;
        }

        .assistant-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 20px;
            width: 20px;
            height: 20px;
            background: var(--card-bg);
            transform: rotate(45deg);
            border-right: 1px solid var(--card-border);
            border-bottom: 1px solid var(--card-border);
        }

        .assistant-bubble-content {
            position: relative;
            z-index: 2;
        }

        .assistant-expanded {
            position: fixed;
            bottom: 120px;
            left: 30px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            width: 320px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            border: 1px solid var(--card-border);
            z-index: 999;
        }

        .assistant-expanded.open {
            max-height: 500px;
            opacity: 1;
            padding: 20px;
        }

        .assistant-expanded-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .assistant-expanded-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--secondary-color);
        }

        .assistant-expanded-close {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(37, 99, 235, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--primary-color);
        }

        .assistant-expanded-close:hover {
            background: var(--primary-color);
            color: var(--light-text);
        }

        .assistant-expanded-content {
            margin-bottom: 15px;
        }

        .assistant-expanded-actions {
            display: flex;
            gap: 10px;
        }

        .assistant-expanded-actions .btn {
            flex: 1;
            padding: 10px;
            font-size: 0.9rem;
        }

        /* Styles pour le module d'analyse */
        .analytics-report {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            padding: 30px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            z-index: 1100;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid var(--card-border);
        }

        .analytics-report.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            visibility: visible;
        }

        .analytics-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1050;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .analytics-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .analytics-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--card-border);
        }

        .analytics-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--secondary-color);
        }

        .analytics-close {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(37, 99, 235, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .analytics-close:hover {
            background: var(--primary-color);
            color: var(--light-text);
        }

        .analytics-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .analytics-card {
            background: var(--bg-color);
            border-radius: 15px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .analytics-card:hover {
            box-shadow: var(--shadow);
            transform: translateY(-5px);
        }

        .analytics-card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .analytics-card-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--light-text);
            font-size: 1.5rem;
        }

        .analytics-card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .analytics-card-content {
            height: 250px;
            position: relative;
        }

        .analytics-chart-container {
            width: 100%;
            height: 100%;
        }

        .heatmap-container {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* 16:9 aspect ratio */
            border: 1px solid var(--card-border);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .heatmap-preview {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(56, 189, 248, 0.05));
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
        }

        .heatmap-cursor {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(37, 99, 235, 0.5);
            transform: translate(-50%, -50%);
            filter: blur(5px);
        }

        /* Animations pour l'avatar qui parle */
        @keyframes talk {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .talking {
            animation: talk 0.5s infinite;
        }

        /* Tooltip pour les boutons de l'assistant */
        .tooltip {
            position: relative;
        }

        .tooltip::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-color);
            color: var(--light-text);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
        }

        .tooltip:hover::before {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>
    <!-- Contenu HTML existant -->
    <!-- ... (garder tout le contenu HTML existant) ... -->

    <!-- Assistant Vocal avec Avatar -->
    <div class="assistant-container" id="assistant-container">
        <div class="assistant-voice-indicator" id="voice-indicator"></div>
        <div class="assistant-avatar" id="assistant-avatar">
            <i class="fas fa-user avatar-icon" id="avatar-icon"></i>
        </div>
        <div class="assistant-bubble" id="assistant-bubble">
            <div class="assistant-bubble-content" id="bubble-content">
                Bonjour ! Je suis l'assistant virtuel de Yassine. Comment puis-je vous aider ?
            </div>
        </div>
        <div class="assistant-controls" id="assistant-controls">
            <div class="assistant-btn tooltip" id="assistant-listen" data-tooltip="Écouter">
                <i class="fas fa-microphone"></i>
            </div>
            <div class="assistant-btn tooltip" id="assistant-mute" data-tooltip="Mute">
                <i class="fas fa-volume-up"></i>
            </div>
            <div class="assistant-btn tooltip" id="assistant-help" data-tooltip="Aide">
                <i class="fas fa-question"></i>
            </div>
            <div class="assistant-btn tooltip" id="assistant-analytics" data-tooltip="Analytics">
                <i class="fas fa-chart-line"></i>
            </div>
        </div>
    </div>

    <div class="assistant-expanded" id="assistant-expanded">
        <div class="assistant-expanded-header">
            <div class="assistant-expanded-title">Assistant Virtuel</div>
            <div class="assistant-expanded-close" id="assistant-expanded-close">
                <i class="fas fa-times"></i>
            </div>
        </div>
        <div class="assistant-expanded-content">
            <p>Je peux vous aider à explorer ce portfolio et répondre à vos questions sur les projets de Yassine.</p>
            <p>Essayez de me demander :</p>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li>Parle-moi du projet d'agriculture</li>
                <li>Quelles sont les compétences de Yassine ?</li>
                <li>Décris le parcours académique</li>
                <li>Comment contacter Yassine ?</li>
            </ul>
        </div>
        <div class="assistant-expanded-actions">
            <button class="btn btn-primary" id="start-assistant-btn">
                <i class="fas fa-play"></i> Commencer
            </button>
            <button class="btn btn-outline" id="settings-assistant-btn">
                <i class="fas fa-cog"></i> Paramètres
            </button>
        </div>
    </div>

    <!-- Module d'analyse des interactions -->
    <div class="analytics-overlay" id="analytics-overlay"></div>
    <div class="analytics-report" id="analytics-report">
        <div class="analytics-header">
            <div class="analytics-title">Analyse des Interactions</div>
            <div class="analytics-close" id="analytics-close">
                <i class="fas fa-times"></i>
            </div>
        </div>
        <div class="analytics-content">
            <div class="analytics-card">
                <div class="analytics-card-header">
                    <div class="analytics-card-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="analytics-card-title">Temps Passé par Section</div>
                </div>
                <div class="analytics-card-content">
                    <div class="analytics-chart-container" id="time-chart"></div>
                </div>
            </div>
            <div class="analytics-card">
                <div class="analytics-card-header">
                    <div class="analytics-card-icon">
                        <i class="fas fa-mouse-pointer"></i>
                    </div>
                    <div class="analytics-card-title">Interactions Utilisateur</div>
                </div>
                <div class="analytics-card-content">
                    <div class="analytics-chart-container" id="interaction-chart"></div>
                </div>
            </div>
            <div class="analytics-card">
                <div class="analytics-card-header">
                    <div class="analytics-card-icon">
                        <i class="fas fa-map"></i>
                    </div>
                    <div class="analytics-card-title">Carte de Chaleur des Mouvements</div>
                </div>
                <div class="analytics-card-content">
                    <div class="heatmap-container">
                        <div class="heatmap-preview" id="heatmap">
                            <div class="heatmap-cursor" style="top: 30%; left: 60%;"></div>
                            <div class="heatmap-cursor" style="top: 50%; left: 40%;"></div>
                            <div class="heatmap-cursor" style="top: 70%; left: 70%;"></div>
                            <div class="heatmap-cursor" style="top: 20%; left: 30%;"></div>
                            <div class="heatmap-cursor" style="top: 80%; left: 50%;"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="analytics-card">
                <div class="analytics-card-header">
                    <div class="analytics-card-icon">
                        <i class="fas fa-thumbs-up"></i>
                    </div>
                    <div class="analytics-card-title">Satisfaction Estimée</div>
                </div>
                <div class="analytics-card-content">
                    <div class="analytics-chart-container" id="satisfaction-chart"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gardez les scripts existants -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    
    <!-- Ajoutez les nouvelles bibliothèques -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <script>
        // Initialisation du code existant
        document.addEventListener('DOMContentLoaded', function() {
            // Code existant du portfolio
            AOS.init({
                duration: 800,
                easing: 'ease-in-out',
                once: true,
                mirror: false
                            });
                        });
                 
            
            // Navbar scroll effect et autres fonctionnalités existantes
            const navbar = document.getElementById('navbar');
            const backToTop = document.getElementById('back-to-top');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const navLinks = document.getElementById('nav-links');
            const navLinkItems = document.querySelectorAll('.nav-link');
            
            // Handle scroll
            window.addEventListener('scroll', function() {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                    backToTop.classList.add('show');
                } else {
                    navbar.classList.remove('scrolled');
                    backToTop.classList.remove('show');
                }
                
                // Update active nav link on scroll
                updateActiveNavLink();
            });
            
            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', function() {
                navLinks.classList.toggle('show');
                const isOpen = navLinks.classList.contains('show');
                mobileMenuBtn.innerHTML = isOpen ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
            });
            
            // Close mobile menu on nav link click
            navLinkItems.forEach(item => {
                item.addEventListener('click', function() {
                    navLinks.classList.remove('show');
                    mobileMenuBtn.innerHTML = '<i class="fas fa-bars"></i>';
                });
            });
            
            // Back to top button click
            backToTop.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // Form submission
            const contactForm = document.getElementById('contact-form');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('Merci pour votre message ! Je vous répondrai dès que possible.');
                    contactForm.reset();
                });
            }
            
            // Update active nav link based on scroll position
            function updateActiveNavLink() {
                const sections = document.querySelectorAll('section');
                let current = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop - 100;
                    const sectionHeight = section.offsetHeight;
                    if (window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight) {
                        current = section.getAttribute('id');
                    }
                });
                
                navLinkItems.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${current}`) {
                        link.classList.add('active');
                    }
                });
            }
            
            // Fix for the "fas fa-chart-network" icon that might not exist
            document.querySelectorAll('.fas.fa-chart-network').forEach(icon => {
                icon.classList.remove('fa-chart-network');
                icon.classList.add('fa-chart-line'); // Use an existing icon as fallback
            });
            
            // ------------------- NOUVEAU CODE -------------------
            
            // ====== SYSTÈME D'ASSISTANT VOCAL ======
            
            // Éléments de l'assistant
            const assistantContainer = document.getElementById('assistant-container');
            const assistantAvatar = document.getElementById('assistant-avatar');
            const assistantBubble = document.getElementById('assistant-bubble');
            const bubbleContent = document.getElementById('bubble-content');
            const voiceIndicator = document.getElementById('voice-indicator');
            const avatarIcon = document.getElementById('avatar-icon');
            const assistantExpanded = document.getElementById('assistant-expanded');
            const assistantExpandedClose = document.getElementById('assistant-expanded-close');
            const startAssistantBtn = document.getElementById('start-assistant-btn');
            const assistantListen = document.getElementById('assistant-listen');
            const assistantMute = document.getElementById('assistant-mute');
            const assistantHelp = document.getElementById('assistant-help');
            const assistantAnalytics = document.getElementById('assistant-analytics');
            
            // Variables pour l'assistant
            let synth = window.speechSynthesis;
            let recognition = null;
            if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
                recognition.lang = 'fr-FR';
                recognition.continuous = false;
                recognition.interimResults = false;
            }
            
            let isMuted = false;
            let isListening = false;
            
            // Base de connaissances de l'assistant
            const knowledgeBase = {
                greetings: [
                    "Bonjour ! Je suis l'assistant virtuel de Yassine. Comment puis-je vous aider ?",
                    "Salut ! Je suis là pour vous guider dans ce portfolio. Que voulez-vous savoir ?",
                    "Bienvenue ! Je peux vous aider à découvrir les projets de Yassine. Que souhaitez-vous explorer ?"
                ],
                agriculture: [
                    "Le projet API Agriculture Intelligente est une innovation qui utilise l'intelligence artificielle pour optimiser les rendements agricoles. Yassine a développé des algorithmes qui analysent les conditions du sol, la météo et d'autres facteurs pour recommander les meilleures pratiques agricoles, tout en réduisant l'impact environnemental.",
                    "Ce projet utilise Python, TensorFlow, FastAPI et Docker. Voulez-vous en savoir plus sur les technologies utilisées ?"
                ],
                skills: [
                    "Yassine possède de solides compétences dans plusieurs domaines. En développement, il maîtrise Python, JavaScript, Java, SQL et C++. Dans le domaine de l'IA et Data Science, il est compétent en Machine Learning, Deep Learning, analyse de données, traitement du langage naturel et frameworks comme TensorFlow et PyTorch. Pour le web et DevOps, il utilise HTML, CSS, React, Git, Docker et les pratiques CI/CD.",
                    "Sa spécialité est l'intelligence artificielle et l'analyse de données. Souhaitez-vous en savoir plus sur un domaine spécifique ?"
                ],
                academic: [
                    "Yassine est étudiant en ingénierie informatique à l'École Supérieure Privée d'Ingénierie et de Technologies (ESPRIT) en Tunisie. Sa formation se concentre sur le génie informatique avec une spécialisation en intelligence artificielle et science des données.",
                    "Il suit une formation d'excellence qui combine théorie et projets pratiques pour développer des solutions technologiques innovantes."
                ],
                contact: [
                    "Vous pouvez contacter Yassine par email à selmi.yassine@esprit.tn. Il est basé à Tunis, en Tunisie. Vous pouvez également le trouver sur LinkedIn, GitHub, Twitter et Medium via les liens dans la section contact du portfolio.",
                    "N'hésitez pas à utiliser le formulaire de contact pour lui envoyer directement un message."
                ],
                fallback: [
                    "Je ne suis pas sûr de comprendre votre question. Essayez de me demander à propos des projets, des compétences ou du parcours académique de Yassine.",
                    "Désolé, je n'ai pas compris. Pouvez-vous reformuler votre question ? Je peux vous parler des projets de Yassine, de ses compétences ou comment le contacter."
                ]
            };
            
            // Afficher la bulle avec un message
            function showBubble(message) {
                bubbleContent.textContent = message;
                assistantBubble.classList.add('show');
                
                // Masquer après 5 secondes
                setTimeout(() => {
                    assistantBubble.classList.remove('show');
                }, 5000);
            }
            
            // Fonction pour faire parler l'assistant
            function speak(text) {
                if (isMuted) return;
                
                // Arrêter toute synthèse vocale en cours
                synth.cancel();
                
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'fr-FR';
                utterance.rate = 1.0;
                utterance.pitch = 1.0;
                
                // Animation de l'avatar qui parle
                voiceIndicator.classList.add('speaking');
                avatarIcon.classList.add('talking');
                
                utterance.onend = function() {
                    voiceIndicator.classList.remove('speaking');
                    avatarIcon.classList.remove('talking');
                };
                
                synth.speak(utterance);
            }
            
            // Écouter l'utilisateur
            function startListening() {
                if (!recognition) {
                    showBubble("Désolé, la reconnaissance vocale n'est pas supportée par votre navigateur.");
                    return;
                }
                
                if (isListening) return;
                
                isListening = true;
                voiceIndicator.classList.add('listening');
                showBubble("Je vous écoute...");
                
                recognition.start();
            }
            
            // Interpréter la commande vocale
            // Fonction pour traiter la commande vocale
function processCommand(command) {
    command = command.toLowerCase();
    
    if (command.includes('bonjour') || command.includes('salut') || command.includes('hey')) {
        const response = knowledgeBase.greetings[Math.floor(Math.random() * knowledgeBase.greetings.length)];
        showBubble(response);
        speak(response);
    } 
    else if (command.includes('agriculture') || command.includes('projet agricole') || command.includes('agriculture intelligente')) {
        const response = knowledgeBase.agriculture.join(' ');
        showBubble(response);
        speak(response);
    } 
    else if (command.includes('compétence') || command.includes('compétences') || command.includes('savoir-faire') || command.includes('aptitude')) {
        const response = knowledgeBase.skills.join(' ');
        showBubble(response);
        speak(response);
    } 
    else if (command.includes('formation') || command.includes('études') || command.includes('parcours') || command.includes('académique')) {
        const response = knowledgeBase.academic.join(' ');
        showBubble(response);
        speak(response);
    } 
    else if (command.includes('contact') || command.includes('contacter') || command.includes('joindre') || command.includes('email')) {
        const response = knowledgeBase.contact.join(' ');
        showBubble(response);
        speak(response);
    } 
    else {
        const response = knowledgeBase.fallback[Math.floor(Math.random() * knowledgeBase.fallback.length)];
        showBubble(response);
        speak(response);
    }
}

// Initialisation des événements de reconnaissance vocale
if (recognition) {
    recognition.onresult = function(event) {
        const command = event.results[0][0].transcript;
        showBubble(`Vous avez dit: "${command}"`);
        processCommand(command);
    };
    
    recognition.onend = function() {
        isListening = false;
        voiceIndicator.classList.remove('listening');
    };
    
    recognition.onerror = function(event) {
        isListening = false;
        voiceIndicator.classList.remove('listening');
        showBubble("Désolé, je n'ai pas compris. Pouvez-vous réessayer ?");
    };
}

// Événement de clic sur l'avatar de l'assistant
assistantAvatar.addEventListener('click', function() {
    assistantContainer.classList.toggle('active');
    
    // Si la bulle est visible, la masquer
    if (assistantBubble.classList.contains('show')) {
        assistantBubble.classList.remove('show');
    } else {
        // Sinon afficher un message de bienvenue
        const greeting = knowledgeBase.greetings[Math.floor(Math.random() * knowledgeBase.greetings.length)];
        showBubble(greeting);
    }
});

// Bouton d'écoute
assistantListen.addEventListener('click', function() {
    startListening();
});

// Bouton de mute
assistantMute.addEventListener('click', function() {
    isMuted = !isMuted;
    if (isMuted) {
        assistantMute.querySelector('i').classList.remove('fa-volume-up');
        assistantMute.querySelector('i').classList.add('fa-volume-mute');
        assistantMute.setAttribute('data-tooltip', 'Unmute');
        
        // Arrêter toute synthèse vocale en cours
        synth.cancel();
    } else {
        assistantMute.querySelector('i').classList.remove('fa-volume-mute');
        assistantMute.querySelector('i').classList.add('fa-volume-up');
        assistantMute.setAttribute('data-tooltip', 'Mute');
    }
});

// Bouton d'aide
assistantHelp.addEventListener('click', function() {
    assistantExpanded.classList.add('open');
});

// Fermeture de l'aide
assistantExpandedClose.addEventListener('click', function() {
    assistantExpanded.classList.remove('open');
});

// Bouton de démarrage dans l'aide
startAssistantBtn.addEventListener('click', function() {
    assistantExpanded.classList.remove('open');
    startListening();
});

// ====== SYSTÈME D'ANALYSE DES INTERACTIONS ======

// Éléments pour le système d'analyse
const analyticsBtn = document.getElementById('assistant-analytics');
const analyticsReport = document.getElementById('analytics-report');
const analyticsOverlay = document.getElementById('analytics-overlay');
const analyticsClose = document.getElementById('analytics-close');

// Données d'exemple pour les graphiques
const timeData = {
    labels: ['Accueil', 'À propos', 'Projets', 'Compétences', 'Contact'],
    datasets: [{
        label: 'Temps passé (secondes)',
        data: [45, 30, 120, 60, 25],
        backgroundColor: 'rgba(37, 99, 235, 0.5)',
        borderColor: 'rgba(37, 99, 235, 1)',
        borderWidth: 1
    }]
};

const interactionData = {
    labels: ['Clics', 'Survols', 'Défilements', 'Questions', 'Interactions vocales'],
    datasets: [{
        label: 'Nombre d\'interactions',
        data: [23, 45, 67, 12, 8],
        backgroundColor: [
            'rgba(37, 99, 235, 0.7)',
            'rgba(56, 189, 248, 0.7)',
            'rgba(251, 146, 60, 0.7)',
            'rgba(52, 211, 153, 0.7)',
            'rgba(139, 92, 246, 0.7)'
        ],
        borderColor: [
            'rgba(37, 99, 235, 1)',
            'rgba(56, 189, 248, 1)',
            'rgba(251, 146, 60, 1)',
            'rgba(52, 211, 153, 1)',
            'rgba(139, 92, 246, 1)'
        ],
        borderWidth: 1
    }]
};

const satisfactionData = {
    labels: ['Très satisfait', 'Satisfait', 'Neutre', 'Peu satisfait', 'Insatisfait'],
    datasets: [{
        label: 'Niveau de satisfaction',
        data: [65, 25, 8, 2, 0],
        backgroundColor: [
            'rgba(52, 211, 153, 0.7)',
            'rgba(56, 189, 248, 0.7)',
            'rgba(251, 146, 60, 0.7)',
            'rgba(251, 113, 133, 0.7)',
            'rgba(239, 68, 68, 0.7)'
        ],
        borderColor: [
            'rgba(52, 211, 153, 1)',
            'rgba(56, 189, 248, 1)',
            'rgba(251, 146, 60, 1)',
            'rgba(251, 113, 133, 1)',
            'rgba(239, 68, 68, 1)'
        ],
        borderWidth: 1
    }]
};

// Créer les graphiques avec Chart.js
function createCharts() {
    // Graphique du temps passé par section
    const timeChart = new Chart(
        document.getElementById('time-chart'),
        {
            type: 'bar',
            data: timeData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        }
    );

    // Graphique des interactions utilisateur
    const interactionChart = new Chart(
        document.getElementById('interaction-chart'),
        {
            type: 'doughnut',
            data: interactionData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            boxWidth: 12,
                            font: {
                                size: 10
                            }
                        }
                    }
                }
            }
        }
    );

    // Graphique de satisfaction
    const satisfactionChart = new Chart(
        document.getElementById('satisfaction-chart'),
        {
            type: 'pie',
            data: satisfactionData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right',
                        labels: {
                            boxWidth: 12,
                            font: {
                                size: 10
                            }
                        }
                    }
                }
            }
        }
    );
}

// Système de suivi des interactions
let pageInteractions = {
    clicks: 0,
    hovers: 0,
    scrolls: 0,
    timeSpent: {}
};

let lastScrollPosition = window.scrollY;
let scrollThreshold = 100;
let scrollCounter = 0;

// Suivre les clics
document.addEventListener('click', function(e) {
    pageInteractions.clicks++;
});

// Suivre les survols
document.addEventListener('mouseover', function(e) {
    if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON' || e.target.closest('.card') || e.target.closest('.project-card')) {
        pageInteractions.hovers++;
    }
});

// Suivre les défilements significatifs
document.addEventListener('scroll', function() {
    if (Math.abs(window.scrollY - lastScrollPosition) > scrollThreshold) {
        pageInteractions.scrolls++;
        lastScrollPosition = window.scrollY;
    }
});

// Suivi du temps passé par section
let sectionTimeTracker = {
    currentSection: '',
    startTime: 0,
    updateCurrentSection: function() {
        const sections = document.querySelectorAll('section');
        let currentSectionId = '';
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop - 100;
            const sectionHeight = section.offsetHeight;
            if (window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight) {
                currentSectionId = section.getAttribute('id');
            }
        });
        
        if (currentSectionId && this.currentSection !== currentSectionId) {
            // Enregistrer le temps pour la section précédente
            if (this.currentSection) {
                const timeSpent = (Date.now() - this.startTime) / 1000; // en secondes
                if (!pageInteractions.timeSpent[this.currentSection]) {
                    pageInteractions.timeSpent[this.currentSection] = 0;
                }
                pageInteractions.timeSpent[this.currentSection] += timeSpent;
            }
            
            // Mettre à jour la section courante
            this.currentSection = currentSectionId;
            this.startTime = Date.now();
        }
    }
};

// Mettre à jour la section courante lors du défilement
window.addEventListener('scroll', function() {
    sectionTimeTracker.updateCurrentSection();
});

// Initialiser le suivi du temps
window.addEventListener('load', function() {
    sectionTimeTracker.updateCurrentSection();
    sectionTimeTracker.startTime = Date.now();
});

// Événements pour le système d'analyse
analyticsBtn.addEventListener('click', function() {
    analyticsReport.classList.add('show');
    analyticsOverlay.classList.add('show');
    
    // Créer les graphiques
    createCharts();
});

analyticsClose.addEventListener('click', function() {
    analyticsReport.classList.remove('show');
    analyticsOverlay.classList.remove('show');
});

analyticsOverlay.addEventListener('click', function() {
    analyticsReport.classList.remove('show');
    analyticsOverlay.classList.remove('show');
});

// Initialisation des animations de la carte de chaleur
function animateHeatMap() {
    const cursors = document.querySelectorAll('.heatmap-cursor');
    cursors.forEach(cursor => {
        const randomX = Math.floor(Math.random() * 100);
        const randomY = Math.floor(Math.random() * 100);
        cursor.style.left = randomX + '%';
        cursor.style.top = randomY + '%';
        
        // Animation de transition
        cursor.style.transition = 'all ' + (Math.random() * 3 + 2) + 's ease-in-out';
    });
    
    setTimeout(animateHeatMap, 3000);
}

// Lancer l'animation de la carte de chaleur
animateHeatMap();

// Salutation initiale après un délai
setTimeout(() => {
    const greeting = knowledgeBase.greetings[Math.floor(Math.random() * knowledgeBase.greetings.length)];
    showBubble(greeting);
}); 
</script>
</body>
</html>
